<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.act.sitting.ISittingDAO">

	<select id="list" resultType="com.act.sitting.SittingDTO">
		SELECT JMNICKNAME, SPTITLE,
		SPADDR1, SPADDR2, MEMSID, SPHSID, SPHSTART, SPHEND
		, SRSTART, SREND,
		SRWSID, STLESID, SPMAXPET, SPSID
		FROM SITTING_PLACE_LIST_VIEW
	</select>

	<select id="IndexTagList"
		resultType="com.act.sitting.SittingDTO">
		SELECT ISPT_SID AS ISPTSID, ISPT_NAME AS ISPTNAME
		FROM
		INDEX_SITTING_PLACE_TAG
		ORDER BY ISPT_SID
	</select>

	<select id="gradeList" resultType="com.act.sitting.SittingDTO">
		SELECT GRADE, PRICE
		FROM
		SITTING_GRADE_VIEW
	</select>

	<!-- <select id="tagList" resultType="com.act.sitting.SittingDTO"> SELECT 
		MEMSID, JMNICKNAME, ISPTSID, ISPTNAME FROM SITTING_PLACE_TAGS_VIEW WHERE 
		MEMSID=#{memSid} </select> -->


	<select id="stsCount" resultType="java.lang.Integer">
		SELECT NVL(COUNT(STS_SID), 0)
		AS STSCOUNT
		FROM STS_CONDITION_VIEW
		WHERE MEM_SID = #{memSid}
	</select>

	<select id="slCount" resultType="java.lang.Integer">
		SELECT NVL(COUNT(SL_SID), 0) AS
		SLCOUNT
		FROM SITTING_LICENSE SL JOIN STS_CONDITION_VIEW SCV
		ON SL.STS_SID = SCV.STS_SID
		WHERE SCV.MEM_SID = #{memSid}
	</select>

	<select id="booklist" resultType="com.act.sitting.SittingDTO">
		SELECT SBSID, SBSTARTYEAR,
		SBSTARTMONTH, SBSTARTDAY, SBEND, SBPRICE, PMEMSID
		FROM
		SITTING_BOOK_VIEW
		WHERE MEMSID = #{memSid}
	</select>
	
	<insert id="addTestRevice">
		INSERT INTO SITTING_TEST_RECEIVE(STR_SID, MEM_SID)
		VALUES (SEQ_STR.NEXTVAL, #{memSid})
	</insert>
	
	<select id="receiveNum" resultType="java.lang.Integer">
		SELECT NVL(MAX(STR_SID), 0) 
		FROM SITTING_TEST_RECEIVE
	</select>
	
	<select id="questionSittingList" resultType="com.act.sitting.SittingQuestionDTO">
    	SELECT STBSID, STBQUESTION, STBANSWER, STBPOINT
   	 	FROM (
        SELECT STB_SID AS STBSID, STB_QUESTION AS STBQUESTION, STB_ANSWER AS STBANSWER, STB_POINT AS STBPOINT,
               ROW_NUMBER() OVER (ORDER BY DBMS_RANDOM.VALUE) AS rn
        FROM SITTING_TEST_BANK
    	)
    	WHERE rn &lt; 10;
	</select>
	
	<insert id="addSittingQuestion">
		INSERT INTO SITTING_TEST_PAPER
		(STR_SID, STB_SID1, STB_SID2, STB_SID3, STB_SID4, STB_SID5, STB_SID6, STB_SID7, STB_SID8, STB_SID9, STB_SID10)
		VALUES
		(#{strsid}, #{stbsid1}, #{stbsid2}, #{stbsid3}, #{stbsid4}, #{stbsid5},
 		#{stbsid6}, #{stbsid7}, #{stbsid8}, #{stbsid9}, #{stbsid10})
	</insert>
	
	

</mapper>